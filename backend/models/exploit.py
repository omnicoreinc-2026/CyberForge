"""Exploit module data models for CyberForge."""

from pydantic import BaseModel, Field


class SQLiResult(BaseModel):
    url: str = Field(default="", description="Target URL tested.")
    parameter: str = Field(default="", description="Vulnerable parameter name.")
    payload_type: str = Field(default="", description="Type of injection: error-based, blind, union, time-based.")
    injectable: bool = Field(default=False, description="Whether the parameter is injectable.")
    dbms: str = Field(default="", description="Detected DBMS if any.")
    evidence: str = Field(default="", description="Evidence of injection.")


class XSSResult(BaseModel):
    url: str = Field(default="", description="Target URL tested.")
    parameter: str = Field(default="", description="Vulnerable parameter.")
    payload: str = Field(default="", description="XSS payload that triggered.")
    xss_type: str = Field(default="reflected", description="Type: reflected, stored, dom.")
    evidence: str = Field(default="", description="Evidence of XSS.")


class DirResult(BaseModel):
    url: str = Field(default="", description="Discovered URL.")
    status_code: int = Field(default=0, description="HTTP response status code.")
    size: int = Field(default=0, description="Response size in bytes.")
    redirect_url: str = Field(default="", description="Redirect target if 3xx.")


class NucleiResult(BaseModel):
    template_id: str = Field(default="", description="Nuclei template identifier.")
    name: str = Field(default="", description="Vulnerability name.")
    severity: str = Field(default="info", description="Severity level.")
    matched_url: str = Field(default="", description="URL that matched.")
    extracted_results: str = Field(default="", description="Extracted data.")


class FuzzResult(BaseModel):
    url: str = Field(default="", description="Fuzzed URL.")
    payload: str = Field(default="", description="Fuzz payload used.")
    status_code: int = Field(default=0, description="Response status.")
    response_length: int = Field(default=0, description="Response body length.")
    anomaly: bool = Field(default=False, description="Whether response was anomalous.")


class CredentialResult(BaseModel):
    host: str = Field(default="", description="Target host.")
    port: int = Field(default=0, description="Target port.")
    service: str = Field(default="", description="Service type: ssh, http, ftp, etc.")
    username: str = Field(default="", description="Username tested.")
    password: str = Field(default="", description="Password tested.")
    success: bool = Field(default=False, description="Whether login succeeded.")


class StrikeChainRequest(BaseModel):
    target: str = Field(..., min_length=1, description="Target URL or host.")
    modules: list[str] = Field(default_factory=lambda: ["sqli", "xss", "dirs", "nuclei", "fuzz", "creds"], description="Modules to run.")
    options: dict = Field(default_factory=dict, description="Per-module options.")
